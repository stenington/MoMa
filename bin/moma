#!/usr/bin/perl

use Pod::Usage;
use App::Moma;
use Getopt::Long qw(:config no_auto_abbrev no_getopt_compat auto_help auto_version prefix=--);

my %opts = ();
GetOptions(
  %opts,
);

my $app = App::Moma->new();
unless( $app->load_rc( "~/.moma" ) ){
  print STDERR "No configuration found at ~/.moma\n";
  pod2usage(1);
}

my $monstr = $ARGV[0];
pod2usage(1) unless $monstr;
unless( $app->parse_args( $monstr ) ){
  print STDERR "Argument $monstr didn't parse\n";
  pod2usage(1);
}
$app->run();

__END__

=head1 moma : MOnitor MAnager

 _______
|,----__|___
||  |,-----.|   moma - switch monitor sets, nice and easy
|`--||     ||
 ``||`-----`|
  ~~~``| |`` 
      ~~~~~

=head1 SYNOPSIS

moma [--help] monitor_string

  Format:
    (+|-)m[n...](+|-)x[y...]
    +m[n...]      turn on m, n, etc.
    -m[n...]      turn off m, n, etc.

  ...where valid identifiers (m, n, etc.) are defined in your ~/.moma file:
    +-----------------+
    |  [identifiers]  |
    |  l=VGA-0        |
    |  r=DVI-0        |
    |  i=LVDS         |
    |                 |
    |  [modes]        |
    |  LVDS=1280x1024 |
    +-----------------+

  Examples:
    +lr-i   dual external monitors
    -l      turn off left monitor
    +i      turn on laptop screen

=head1 DESCRIPTION

B<This program> will toggle the desired set of monitors. 

=cut
